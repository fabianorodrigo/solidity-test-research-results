const truffleAssert = require('truffle-assertions');
const PaymentTokenMock = artifacts.require("PaymentTokenMock");
const RedeemableTokenMock = artifacts.require("RedeemableTokenMock");
const OffChainPayments = artifacts.require("OffChainPayments");
const OnChainPayments = artifacts.require("OnChainPayments");
const FixedPriceTender = artifacts.require("FixedPriceTender");
const FullRedemption = artifacts.require("FullRedemption");
const PartialRedemption = artifacts.require("PartialRedemption");
const RedeemableToken = artifacts.require("RedeemableToken");
const OnChainVoting = artifacts.require("OnChainVoting");
const ECDSA = artifacts.require("openzeppelin-solidity/contracts/cryptography/ECDSA.sol");
const Math = artifacts.require("openzeppelin-solidity/contracts/math/Math.sol");
const SafeMath = artifacts.require("openzeppelin-solidity/contracts/math/SafeMath.sol");
const ERC20 = artifacts.require("openzeppelin-solidity/contracts/token/ERC20/ERC20.sol");

contract("OffChainPayments",(accounts)=>{
  let trace = false;
  let contractSafeMath = null;
  let contractMath = null;
  let contractECDSA = null;
  let contractERC20 = null;
  let contractRedeemableToken = null;
  let contractPaymentTokenMock = null;
  let contractRedeemableTokenMock = null;
  let contractOffChainPayments = null;
  let contractPartialRedemption = null;
  let contractOnChainPayments = null;
  let contractFixedPriceTender = null;
  let contractFullRedemption = null;
  let contractOnChainVoting = null;
  beforeEach(async () => {
    contractSafeMath = await SafeMath.new({from: accounts[0]});
    if(trace) console.log('SUCESSO: SafeMath.new({from: accounts[0]}');
    contractMath = await Math.new({from: accounts[0]});
    if(trace) console.log('SUCESSO: Math.new({from: accounts[0]}');
    contractECDSA = await ECDSA.new({from: accounts[0]});
    if(trace) console.log('SUCESSO: ECDSA.new({from: accounts[0]}');
    ERC20.link("SafeMath",contractSafeMath.address);
    contractERC20 = await ERC20.new({from: accounts[0]});
    if(trace) console.log('SUCESSO: ERC20.new({from: accounts[0]}');
    RedeemableToken.link("SafeMath",contractSafeMath.address);
    contractRedeemableToken = await RedeemableToken.new({from: accounts[0]});
    if(trace) console.log('SUCESSO: RedeemableToken.new({from: accounts[0]}');
    contractPaymentTokenMock = await PaymentTokenMock.new(accounts[8],29,{from:accounts[0]});
    if(trace) console.log('SUCESSO: PaymentTokenMock.new(accounts[8],29,{from:accounts[0]}');
    contractRedeemableTokenMock = await RedeemableTokenMock.new(accounts[1],1532892062,{from:accounts[0]});
    if(trace) console.log('SUCESSO: RedeemableTokenMock.new(accounts[1],1532892062,{from:accounts[0]}');
    OffChainPayments.link("SafeMath",contractSafeMath.address);
     OffChainPayments.link("ECDSA",contractECDSA.address);
    contractOffChainPayments = await OffChainPayments.new(accounts[7],{from:accounts[4]});
    if(trace) console.log('SUCESSO: OffChainPayments.new(accounts[7],{from:accounts[4]}');
    PartialRedemption.link("SafeMath",contractSafeMath.address);
    contractPartialRedemption = await PartialRedemption.new(contractPaymentTokenMock.address,contractRedeemableToken.address,accounts[1],66,{from:accounts[0]});
    if(trace) console.log('SUCESSO: PartialRedemption.new(contractPaymentTokenMock.address,contractRedeemableToken.address,accounts[1],66,{from:accounts[0]}');
    OnChainPayments.link("SafeMath",contractSafeMath.address);
     OnChainPayments.link("ECDSA",contractECDSA.address);
    contractOnChainPayments = await OnChainPayments.new(contractPaymentTokenMock.address,contractRedeemableToken.address,accounts[9],{from:accounts[0]});
    if(trace) console.log('SUCESSO: OnChainPayments.new(contractPaymentTokenMock.address,contractRedeemableToken.address,accounts[9],{from:accounts[0]}');
    FixedPriceTender.link("Math",contractMath.address);
     FixedPriceTender.link("SafeMath",contractSafeMath.address);
    contractFixedPriceTender = await FixedPriceTender.new(1337,contractRedeemableToken.address,contractRedeemableTokenMock.address,accounts[5],9999,2014223715,{from:accounts[6]});
    if(trace) console.log('SUCESSO: FixedPriceTender.new(1337,contractRedeemableToken.address,contractRedeemableTokenMock.address,accounts[5],9999,2014223715,{from:accounts[6]}');
    FullRedemption.link("SafeMath",contractSafeMath.address);
    contractFullRedemption = await FullRedemption.new(contractRedeemableTokenMock.address,contractRedeemableTokenMock.address,accounts[5],1532892063,{from:accounts[0]});
    if(trace) console.log('SUCESSO: FullRedemption.new(contractRedeemableTokenMock.address,contractRedeemableTokenMock.address,accounts[5],1532892063,{from:accounts[0]}');
    OnChainVoting.link("SafeMath",contractSafeMath.address);
    contractOnChainVoting = await OnChainVoting.new(contractRedeemableTokenMock.address,accounts[6],(await web3.eth.getBlock(await web3.eth.getBlockNumber())).timestamp+665,{from:accounts[8]});
    if(trace) console.log('SUCESSO: OnChainVoting.new(contractRedeemableTokenMock.address,accounts[6],(await web3.eth.getBlock(await web3.eth.getBlockNumber())).timestamp+665,{from:accounts[8]}');
  });
  
  it('Should execute recordPayments(address[],uint256[],uint256[],bytes32[]) WHEN msg.sender==_owner,_securityHolders.length>0,_securityHolders.length==_offchainPaymentHashes.length,_securityHolders.length==_paymentTimestamps.length,_securityHolders.length==_paymentValues.length', async () => {
    let result = await contractOffChainPayments.recordPayments([accounts[2],accounts[9],accounts[4],accounts[3],accounts[3],accounts[4],accounts[7],accounts[0],accounts[4],accounts[7],accounts[6],accounts[3],accounts[9],accounts[7],accounts[0],accounts[7],accounts[6],accounts[2],accounts[8],accounts[6],accounts[1],accounts[7],accounts[5],accounts[0],accounts[9],accounts[7],accounts[4],accounts[3],accounts[2],accounts[7],accounts[6],accounts[0],accounts[2],accounts[3],accounts[0],accounts[7],accounts[3],accounts[7],accounts[9],accounts[3],accounts[5],accounts[3],accounts[4],accounts[0],accounts[8],accounts[0],accounts[4],accounts[2],accounts[3],accounts[8],accounts[7],accounts[3],accounts[9],accounts[3],accounts[9],accounts[1],accounts[6],accounts[9],accounts[4],accounts[0],accounts[5],accounts[9],accounts[3],accounts[8],accounts[7]], [2,64,256,65,0,257,3,4,2014223716,6,4,2014223715,9999,1338,66,10000,2014223714,1532892064,97,29,97,254,66,0,1336,9999,96,2,28,2014223715,28,97,1,1336,5,255,1532892064,1338,65,95,28,1532892062,9999,10000,1532892063,9999,64,97,1,255,29,64,2014223714,257,9999,10000,6,29,10001,1337,1532892063,9999,1338,1532892063,97], [10001,2014223715,1532892064,6,6,257,2014223715,2014223716,96,27,257,256,3,2014223715,96,66,65,95,6,1532892062,3,64,96,27,10001,4,2014223715,28,257,10000,28,6,257,26,66,1337,254,6,3,1532892064,2014223714,2014223714,1338,27,97,2,64,5,65,2014223715,3,256,64,2014223714,1,256,96,2014223714,29,256,66,10001,1532892064,26,28], [[25,144,227,4,186,174,189,232,200,119,214,174,245,229,227,3,189,98,173,236,228,85,13,69,117,197,221,38,85,85,113,166],[40,242,8,207,246,165,65,47,19,210,22,60,29,153,0,141,209,236,160,201,174,75,105,174,106,76,209,115,148,73,231,150],[26,55,120,204,150,238,208,66,90,182,248,185,22,245,115,41,237,36,183,107,128,186,210,47,62,206,1,35,221,214,244,5],[200,89,104,53,139,23,254,136,245,109,122,240,58,107,179,7,199,225,136,111,224,134,19,20,99,68,125,22,150,126,235,133],[164,153,208,155,209,91,229,241,33,216,13,44,245,43,243,199,36,248,155,42,108,13,106,143,182,58,69,188,149,152,8,246],[237,88,127,151,60,246,11,174,5,153,164,1,189,8,211,245,39,195,64,41,252,173,40,186,158,56,115,172,206,217,34,38],[116,35,232,85,228,247,76,133,192,180,221,34,226,94,151,139,144,203,247,246,88,75,17,96,117,245,150,221,60,12,34,216],[202,100,106,138,7,14,112,220,0,193,23,153,56,141,241,252,62,86,34,168,58,21,212,72,165,58,41,200,135,85,102,180],[206,137,174,43,254,243,247,24,97,109,60,110,9,205,250,252,69,103,217,13,246,115,44,36,86,206,166,186,236,25,14,248],[35,64,187,161,205,246,108,194,14,59,72,60,9,136,179,111,48,21,155,165,91,247,33,79,35,73,212,151,218,136,79,74],[173,195,68,62,197,52,205,37,195,161,172,89,83,68,165,239,255,3,35,28,165,109,220,241,168,165,189,215,166,25,7,218],[234,242,40,187,89,27,26,198,118,242,253,162,255,149,222,34,100,74,164,100,179,108,119,33,248,104,169,10,31,104,14,222],[105,163,226,140,143,96,139,67,21,124,92,52,248,86,73,45,175,121,230,206,102,213,32,214,19,186,234,189,253,75,159,29],[220,64,182,11,158,254,231,47,16,202,92,104,80,90,134,176,110,6,153,169,13,37,108,30,153,214,245,158,254,35,87,176],[175,230,113,244,42,0,249,182,176,178,58,41,216,90,94,237,18,250,50,223,37,230,181,94,91,107,100,33,31,82,103,116],[146,230,143,25,17,232,67,157,170,100,246,61,134,160,242,66,79,61,184,60,64,171,147,193,174,133,111,115,159,155,126,62],[51,110,231,228,94,117,64,161,70,107,52,110,121,140,7,52,221,203,163,247,136,91,162,94,146,129,120,56,1,171,151,165],[134,173,193,87,147,2,212,202,19,59,89,93,230,102,182,108,152,242,115,34,216,3,232,218,205,140,15,141,2,186,224,48],[207,176,177,205,252,21,230,192,170,120,134,59,253,151,238,245,66,118,227,99,113,47,243,210,16,251,73,215,16,197,138,111],[185,161,199,161,217,139,46,168,156,12,25,38,168,240,199,111,46,183,12,153,16,190,105,147,166,117,152,190,112,47,127,30],[24,174,90,70,210,84,8,9,114,108,191,157,35,3,130,221,121,210,205,225,179,130,242,10,63,250,113,240,120,112,233,66],[228,212,122,71,68,114,41,26,229,70,185,227,201,92,109,103,41,57,27,148,20,169,165,79,13,98,134,149,146,66,226,192],[182,210,176,74,59,113,106,120,247,166,148,197,248,4,127,6,136,166,1,208,152,103,131,59,163,158,171,112,138,246,83,26],[57,202,251,228,177,226,204,59,52,3,176,36,83,232,146,238,122,14,151,0,223,3,102,227,161,178,64,89,55,169,43,98],[40,26,129,213,108,115,6,177,58,223,63,217,120,223,151,252,42,196,112,35,88,233,135,69,231,202,35,44,16,16,52,91],[253,53,194,28,146,229,113,62,240,176,110,247,60,100,236,161,47,178,100,119,73,147,7,180,73,63,178,141,165,125,34,231],[68,80,109,161,204,26,214,253,254,227,29,144,183,121,216,129,197,2,198,184,130,88,227,166,240,44,184,183,93,77,101,149],[203,242,7,87,183,112,26,188,85,150,180,35,113,142,173,155,250,159,197,101,251,138,102,151,179,70,225,94,196,193,178,58],[152,55,97,3,77,5,2,225,130,19,41,21,87,39,184,100,156,68,10,227,112,35,243,105,69,222,231,26,204,35,70,180],[40,199,135,131,238,21,67,171,163,8,78,53,146,125,150,107,89,226,27,82,83,199,170,151,58,11,57,171,161,176,141,239],[135,233,21,2,231,234,166,52,75,207,149,224,38,81,1,6,238,221,107,255,8,12,186,76,26,252,234,212,32,98,137,87],[119,102,7,39,210,0,198,101,3,182,129,92,107,104,53,12,27,178,74,24,186,200,249,13,44,170,133,96,248,255,184,87],[1,146,23,88,159,148,114,89,186,31,243,130,109,132,239,213,201,183,191,88,56,62,19,69,193,96,25,161,219,115,255,73],[148,178,17,231,202,248,210,231,164,119,5,162,243,57,121,63,39,3,29,136,135,90,58,170,104,35,193,201,79,193,150,222],[41,251,242,179,90,33,191,142,130,208,152,109,202,171,84,54,27,179,214,166,233,117,36,249,182,172,8,203,34,113,35,86],[167,117,49,97,23,91,65,150,162,220,120,39,191,236,73,214,236,13,102,151,17,55,101,178,95,143,45,155,156,62,98,6],[158,144,220,106,124,83,97,85,122,48,180,29,183,201,1,37,108,107,170,249,250,73,181,131,15,204,162,243,86,118,62,149],[33,172,204,116,94,38,31,34,248,238,145,206,199,42,178,37,121,138,67,143,95,173,171,111,99,50,1,124,216,200,176,221],[227,1,211,220,230,98,9,73,127,20,164,254,1,197,21,98,209,122,71,252,30,65,23,158,61,139,68,116,85,246,99,199],[253,60,245,81,195,205,111,88,113,4,4,6,58,132,60,30,27,209,200,12,28,26,23,31,226,114,42,133,83,53,72,175],[26,192,177,94,227,192,55,145,240,74,166,191,22,9,52,26,129,40,53,36,50,221,83,228,219,238,243,207,93,208,191,46],[46,130,145,103,6,40,95,1,170,222,125,233,93,185,171,26,154,95,242,166,24,23,164,103,190,80,73,146,18,126,41,227],[198,91,201,155,142,158,140,253,184,175,229,57,109,113,194,73,26,0,36,138,158,94,88,182,233,100,70,89,216,163,36,7],[200,39,76,218,31,134,218,1,242,122,42,190,242,145,85,69,122,31,26,194,182,5,40,20,117,54,125,187,33,164,155,225],[77,131,49,142,86,255,243,230,236,82,184,85,10,67,150,7,251,97,245,225,69,78,249,16,129,84,87,197,10,50,135,41],[224,240,46,249,235,226,104,118,162,50,188,110,87,36,114,37,120,27,143,151,68,18,23,138,7,130,193,192,106,191,7,201],[239,159,86,79,178,164,55,14,181,220,70,103,174,180,71,199,251,49,90,200,226,190,236,120,163,3,16,181,71,12,151,206],[58,200,6,85,95,202,71,200,181,239,253,135,98,192,59,129,122,136,248,164,239,179,91,241,43,36,45,203,7,21,115,79],[162,145,91,115,153,196,65,165,76,163,12,24,168,79,254,174,96,102,229,52,137,219,19,175,219,189,98,197,79,212,225,166],[117,101,111,151,94,135,225,201,203,180,157,246,103,212,211,77,96,230,13,156,251,192,147,210,243,83,234,85,189,44,182,69],[172,238,155,200,116,242,1,7,101,117,114,84,187,121,57,11,41,187,155,229,136,191,31,181,203,42,174,100,229,141,10,124],[131,187,136,11,205,196,229,50,245,123,32,253,249,10,106,164,162,123,162,246,221,116,53,79,198,220,202,56,99,45,35,201],[57,222,210,184,144,24,111,101,204,41,162,29,115,172,77,227,156,203,116,117,116,254,191,151,210,2,99,54,77,40,4,248],[121,45,212,214,233,218,233,91,43,169,11,33,36,74,135,15,127,104,110,76,77,116,142,116,171,4,237,94,0,5,107,196],[52,33,18,97,56,200,25,144,107,137,148,129,75,243,239,115,91,100,71,134,44,64,210,72,227,247,211,67,109,96,126,23],[136,145,180,3,101,24,127,197,163,32,203,61,98,193,2,109,162,234,61,150,161,93,177,123,121,84,146,211,156,107,30,150],[191,196,196,190,254,159,101,188,91,97,0,95,150,58,231,91,74,235,194,143,180,232,81,169,37,219,170,140,142,17,240,102],[54,143,113,222,218,59,145,239,10,201,112,2,203,167,20,185,207,130,240,205,84,225,157,76,89,167,15,225,199,224,5,24],[234,252,44,154,173,22,85,148,136,182,64,217,106,65,128,41,65,106,111,123,24,207,200,94,203,202,248,23,148,4,50,180],[229,4,97,177,27,68,18,130,140,222,50,16,188,110,179,227,11,55,115,72,210,196,100,79,231,239,112,182,125,25,76,111],[147,225,252,147,249,238,19,16,106,0,76,124,250,170,241,88,236,65,40,130,132,179,201,117,103,245,21,246,143,147,239,36],[30,247,116,88,192,214,61,97,119,251,93,214,150,204,162,25,91,34,72,33,69,44,8,86,62,236,240,17,132,53,144,23],[246,99,70,50,172,2,50,71,143,198,181,20,59,147,185,101,45,139,141,234,236,31,37,233,106,29,195,104,103,53,117,29],[241,111,186,224,228,236,160,234,52,84,217,53,20,56,63,202,81,155,225,126,54,198,207,228,3,245,68,183,138,89,202,209],[212,127,255,206,181,220,100,158,155,201,184,224,43,170,58,103,3,150,62,179,70,9,121,72,71,251,134,195,183,0,66,60]],{from: accounts[4]});
  });
  it('Should fail recordPayments(address[],uint256[],uint256[],bytes32[]) when NOT comply with: msg.sender == _owner', async () => {
    let result = await truffleAssert.fails(contractOffChainPayments.recordPayments([accounts[2],accounts[9],accounts[4],accounts[3],accounts[3],accounts[4],accounts[7],accounts[0],accounts[4],accounts[7],accounts[6],accounts[3],accounts[9],accounts[7],accounts[0],accounts[7],accounts[6],accounts[2],accounts[8],accounts[6],accounts[1],accounts[7],accounts[5],accounts[0],accounts[9],accounts[7],accounts[4],accounts[3],accounts[2],accounts[7],accounts[6],accounts[0],accounts[2],accounts[3],accounts[0],accounts[7],accounts[3],accounts[7],accounts[9],accounts[3],accounts[5],accounts[3],accounts[4],accounts[0],accounts[8],accounts[0],accounts[4],accounts[2],accounts[3],accounts[8],accounts[7],accounts[3],accounts[9],accounts[3],accounts[9],accounts[1],accounts[6],accounts[9],accounts[4],accounts[0],accounts[5],accounts[9],accounts[3],accounts[8],accounts[7]], [2,64,256,65,0,257,3,4,2014223716,6,4,2014223715,9999,1338,66,10000,2014223714,1532892064,97,29,97,254,66,0,1336,9999,96,2,28,2014223715,28,97,1,1336,5,255,1532892064,1338,65,95,28,1532892062,9999,10000,1532892063,9999,64,97,1,255,29,64,2014223714,257,9999,10000,6,29,10001,1337,1532892063,9999,1338,1532892063,97], [10001,2014223715,1532892064,6,6,257,2014223715,2014223716,96,27,257,256,3,2014223715,96,66,65,95,6,1532892062,3,64,96,27,10001,4,2014223715,28,257,10000,28,6,257,26,66,1337,254,6,3,1532892064,2014223714,2014223714,1338,27,97,2,64,5,65,2014223715,3,256,64,2014223714,1,256,96,2014223714,29,256,66,10001,1532892064,26,28], [[25,144,227,4,186,174,189,232,200,119,214,174,245,229,227,3,189,98,173,236,228,85,13,69,117,197,221,38,85,85,113,166],[40,242,8,207,246,165,65,47,19,210,22,60,29,153,0,141,209,236,160,201,174,75,105,174,106,76,209,115,148,73,231,150],[26,55,120,204,150,238,208,66,90,182,248,185,22,245,115,41,237,36,183,107,128,186,210,47,62,206,1,35,221,214,244,5],[200,89,104,53,139,23,254,136,245,109,122,240,58,107,179,7,199,225,136,111,224,134,19,20,99,68,125,22,150,126,235,133],[164,153,208,155,209,91,229,241,33,216,13,44,245,43,243,199,36,248,155,42,108,13,106,143,182,58,69,188,149,152,8,246],[237,88,127,151,60,246,11,174,5,153,164,1,189,8,211,245,39,195,64,41,252,173,40,186,158,56,115,172,206,217,34,38],[116,35,232,85,228,247,76,133,192,180,221,34,226,94,151,139,144,203,247,246,88,75,17,96,117,245,150,221,60,12,34,216],[202,100,106,138,7,14,112,220,0,193,23,153,56,141,241,252,62,86,34,168,58,21,212,72,165,58,41,200,135,85,102,180],[206,137,174,43,254,243,247,24,97,109,60,110,9,205,250,252,69,103,217,13,246,115,44,36,86,206,166,186,236,25,14,248],[35,64,187,161,205,246,108,194,14,59,72,60,9,136,179,111,48,21,155,165,91,247,33,79,35,73,212,151,218,136,79,74],[173,195,68,62,197,52,205,37,195,161,172,89,83,68,165,239,255,3,35,28,165,109,220,241,168,165,189,215,166,25,7,218],[234,242,40,187,89,27,26,198,118,242,253,162,255,149,222,34,100,74,164,100,179,108,119,33,248,104,169,10,31,104,14,222],[105,163,226,140,143,96,139,67,21,124,92,52,248,86,73,45,175,121,230,206,102,213,32,214,19,186,234,189,253,75,159,29],[220,64,182,11,158,254,231,47,16,202,92,104,80,90,134,176,110,6,153,169,13,37,108,30,153,214,245,158,254,35,87,176],[175,230,113,244,42,0,249,182,176,178,58,41,216,90,94,237,18,250,50,223,37,230,181,94,91,107,100,33,31,82,103,116],[146,230,143,25,17,232,67,157,170,100,246,61,134,160,242,66,79,61,184,60,64,171,147,193,174,133,111,115,159,155,126,62],[51,110,231,228,94,117,64,161,70,107,52,110,121,140,7,52,221,203,163,247,136,91,162,94,146,129,120,56,1,171,151,165],[134,173,193,87,147,2,212,202,19,59,89,93,230,102,182,108,152,242,115,34,216,3,232,218,205,140,15,141,2,186,224,48],[207,176,177,205,252,21,230,192,170,120,134,59,253,151,238,245,66,118,227,99,113,47,243,210,16,251,73,215,16,197,138,111],[185,161,199,161,217,139,46,168,156,12,25,38,168,240,199,111,46,183,12,153,16,190,105,147,166,117,152,190,112,47,127,30],[24,174,90,70,210,84,8,9,114,108,191,157,35,3,130,221,121,210,205,225,179,130,242,10,63,250,113,240,120,112,233,66],[228,212,122,71,68,114,41,26,229,70,185,227,201,92,109,103,41,57,27,148,20,169,165,79,13,98,134,149,146,66,226,192],[182,210,176,74,59,113,106,120,247,166,148,197,248,4,127,6,136,166,1,208,152,103,131,59,163,158,171,112,138,246,83,26],[57,202,251,228,177,226,204,59,52,3,176,36,83,232,146,238,122,14,151,0,223,3,102,227,161,178,64,89,55,169,43,98],[40,26,129,213,108,115,6,177,58,223,63,217,120,223,151,252,42,196,112,35,88,233,135,69,231,202,35,44,16,16,52,91],[253,53,194,28,146,229,113,62,240,176,110,247,60,100,236,161,47,178,100,119,73,147,7,180,73,63,178,141,165,125,34,231],[68,80,109,161,204,26,214,253,254,227,29,144,183,121,216,129,197,2,198,184,130,88,227,166,240,44,184,183,93,77,101,149],[203,242,7,87,183,112,26,188,85,150,180,35,113,142,173,155,250,159,197,101,251,138,102,151,179,70,225,94,196,193,178,58],[152,55,97,3,77,5,2,225,130,19,41,21,87,39,184,100,156,68,10,227,112,35,243,105,69,222,231,26,204,35,70,180],[40,199,135,131,238,21,67,171,163,8,78,53,146,125,150,107,89,226,27,82,83,199,170,151,58,11,57,171,161,176,141,239],[135,233,21,2,231,234,166,52,75,207,149,224,38,81,1,6,238,221,107,255,8,12,186,76,26,252,234,212,32,98,137,87],[119,102,7,39,210,0,198,101,3,182,129,92,107,104,53,12,27,178,74,24,186,200,249,13,44,170,133,96,248,255,184,87],[1,146,23,88,159,148,114,89,186,31,243,130,109,132,239,213,201,183,191,88,56,62,19,69,193,96,25,161,219,115,255,73],[148,178,17,231,202,248,210,231,164,119,5,162,243,57,121,63,39,3,29,136,135,90,58,170,104,35,193,201,79,193,150,222],[41,251,242,179,90,33,191,142,130,208,152,109,202,171,84,54,27,179,214,166,233,117,36,249,182,172,8,203,34,113,35,86],[167,117,49,97,23,91,65,150,162,220,120,39,191,236,73,214,236,13,102,151,17,55,101,178,95,143,45,155,156,62,98,6],[158,144,220,106,124,83,97,85,122,48,180,29,183,201,1,37,108,107,170,249,250,73,181,131,15,204,162,243,86,118,62,149],[33,172,204,116,94,38,31,34,248,238,145,206,199,42,178,37,121,138,67,143,95,173,171,111,99,50,1,124,216,200,176,221],[227,1,211,220,230,98,9,73,127,20,164,254,1,197,21,98,209,122,71,252,30,65,23,158,61,139,68,116,85,246,99,199],[253,60,245,81,195,205,111,88,113,4,4,6,58,132,60,30,27,209,200,12,28,26,23,31,226,114,42,133,83,53,72,175],[26,192,177,94,227,192,55,145,240,74,166,191,22,9,52,26,129,40,53,36,50,221,83,228,219,238,243,207,93,208,191,46],[46,130,145,103,6,40,95,1,170,222,125,233,93,185,171,26,154,95,242,166,24,23,164,103,190,80,73,146,18,126,41,227],[198,91,201,155,142,158,140,253,184,175,229,57,109,113,194,73,26,0,36,138,158,94,88,182,233,100,70,89,216,163,36,7],[200,39,76,218,31,134,218,1,242,122,42,190,242,145,85,69,122,31,26,194,182,5,40,20,117,54,125,187,33,164,155,225],[77,131,49,142,86,255,243,230,236,82,184,85,10,67,150,7,251,97,245,225,69,78,249,16,129,84,87,197,10,50,135,41],[224,240,46,249,235,226,104,118,162,50,188,110,87,36,114,37,120,27,143,151,68,18,23,138,7,130,193,192,106,191,7,201],[239,159,86,79,178,164,55,14,181,220,70,103,174,180,71,199,251,49,90,200,226,190,236,120,163,3,16,181,71,12,151,206],[58,200,6,85,95,202,71,200,181,239,253,135,98,192,59,129,122,136,248,164,239,179,91,241,43,36,45,203,7,21,115,79],[162,145,91,115,153,196,65,165,76,163,12,24,168,79,254,174,96,102,229,52,137,219,19,175,219,189,98,197,79,212,225,166],[117,101,111,151,94,135,225,201,203,180,157,246,103,212,211,77,96,230,13,156,251,192,147,210,243,83,234,85,189,44,182,69],[172,238,155,200,116,242,1,7,101,117,114,84,187,121,57,11,41,187,155,229,136,191,31,181,203,42,174,100,229,141,10,124],[131,187,136,11,205,196,229,50,245,123,32,253,249,10,106,164,162,123,162,246,221,116,53,79,198,220,202,56,99,45,35,201],[57,222,210,184,144,24,111,101,204,41,162,29,115,172,77,227,156,203,116,117,116,254,191,151,210,2,99,54,77,40,4,248],[121,45,212,214,233,218,233,91,43,169,11,33,36,74,135,15,127,104,110,76,77,116,142,116,171,4,237,94,0,5,107,196],[52,33,18,97,56,200,25,144,107,137,148,129,75,243,239,115,91,100,71,134,44,64,210,72,227,247,211,67,109,96,126,23],[136,145,180,3,101,24,127,197,163,32,203,61,98,193,2,109,162,234,61,150,161,93,177,123,121,84,146,211,156,107,30,150],[191,196,196,190,254,159,101,188,91,97,0,95,150,58,231,91,74,235,194,143,180,232,81,169,37,219,170,140,142,17,240,102],[54,143,113,222,218,59,145,239,10,201,112,2,203,167,20,185,207,130,240,205,84,225,157,76,89,167,15,225,199,224,5,24],[234,252,44,154,173,22,85,148,136,182,64,217,106,65,128,41,65,106,111,123,24,207,200,94,203,202,248,23,148,4,50,180],[229,4,97,177,27,68,18,130,140,222,50,16,188,110,179,227,11,55,115,72,210,196,100,79,231,239,112,182,125,25,76,111],[147,225,252,147,249,238,19,16,106,0,76,124,250,170,241,88,236,65,40,130,132,179,201,117,103,245,21,246,143,147,239,36],[30,247,116,88,192,214,61,97,119,251,93,214,150,204,162,25,91,34,72,33,69,44,8,86,62,236,240,17,132,53,144,23],[246,99,70,50,172,2,50,71,143,198,181,20,59,147,185,101,45,139,141,234,236,31,37,233,106,29,195,104,103,53,117,29],[241,111,186,224,228,236,160,234,52,84,217,53,20,56,63,202,81,155,225,126,54,198,207,228,3,245,68,183,138,89,202,209],[212,127,255,206,181,220,100,158,155,201,184,224,43,170,58,103,3,150,62,179,70,9,121,72,71,251,134,195,183,0,66,60]],{from: accounts[9]}),'revert');
  });
  it('Should fail recordPayments(address[],uint256[],uint256[],bytes32[]) when NOT comply with: _securityHolders.length > 0', async () => {
    let result = await truffleAssert.fails(contractOffChainPayments.recordPayments([], [2,64,256,65,0,257,3,4,2014223716,6,4,2014223715,9999,1338,66,10000,2014223714,1532892064,97,29,97,254,66,0,1336,9999,96,2,28,2014223715,28,97,1,1336,5,255,1532892064,1338,65,95,28,1532892062,9999,10000,1532892063,9999,64,97,1,255,29,64,2014223714,257,9999,10000,6,29,10001,1337,1532892063,9999,1338,1532892063,97], [10001,2014223715,1532892064,6,6,257,2014223715,2014223716,96,27,257,256,3,2014223715,96,66,65,95,6,1532892062,3,64,96,27,10001,4,2014223715,28,257,10000,28,6,257,26,66,1337,254,6,3,1532892064,2014223714,2014223714,1338,27,97,2,64,5,65,2014223715,3,256,64,2014223714,1,256,96,2014223714,29,256,66,10001,1532892064,26,28], [[25,144,227,4,186,174,189,232,200,119,214,174,245,229,227,3,189,98,173,236,228,85,13,69,117,197,221,38,85,85,113,166],[40,242,8,207,246,165,65,47,19,210,22,60,29,153,0,141,209,236,160,201,174,75,105,174,106,76,209,115,148,73,231,150],[26,55,120,204,150,238,208,66,90,182,248,185,22,245,115,41,237,36,183,107,128,186,210,47,62,206,1,35,221,214,244,5],[200,89,104,53,139,23,254,136,245,109,122,240,58,107,179,7,199,225,136,111,224,134,19,20,99,68,125,22,150,126,235,133],[164,153,208,155,209,91,229,241,33,216,13,44,245,43,243,199,36,248,155,42,108,13,106,143,182,58,69,188,149,152,8,246],[237,88,127,151,60,246,11,174,5,153,164,1,189,8,211,245,39,195,64,41,252,173,40,186,158,56,115,172,206,217,34,38],[116,35,232,85,228,247,76,133,192,180,221,34,226,94,151,139,144,203,247,246,88,75,17,96,117,245,150,221,60,12,34,216],[202,100,106,138,7,14,112,220,0,193,23,153,56,141,241,252,62,86,34,168,58,21,212,72,165,58,41,200,135,85,102,180],[206,137,174,43,254,243,247,24,97,109,60,110,9,205,250,252,69,103,217,13,246,115,44,36,86,206,166,186,236,25,14,248],[35,64,187,161,205,246,108,194,14,59,72,60,9,136,179,111,48,21,155,165,91,247,33,79,35,73,212,151,218,136,79,74],[173,195,68,62,197,52,205,37,195,161,172,89,83,68,165,239,255,3,35,28,165,109,220,241,168,165,189,215,166,25,7,218],[234,242,40,187,89,27,26,198,118,242,253,162,255,149,222,34,100,74,164,100,179,108,119,33,248,104,169,10,31,104,14,222],[105,163,226,140,143,96,139,67,21,124,92,52,248,86,73,45,175,121,230,206,102,213,32,214,19,186,234,189,253,75,159,29],[220,64,182,11,158,254,231,47,16,202,92,104,80,90,134,176,110,6,153,169,13,37,108,30,153,214,245,158,254,35,87,176],[175,230,113,244,42,0,249,182,176,178,58,41,216,90,94,237,18,250,50,223,37,230,181,94,91,107,100,33,31,82,103,116],[146,230,143,25,17,232,67,157,170,100,246,61,134,160,242,66,79,61,184,60,64,171,147,193,174,133,111,115,159,155,126,62],[51,110,231,228,94,117,64,161,70,107,52,110,121,140,7,52,221,203,163,247,136,91,162,94,146,129,120,56,1,171,151,165],[134,173,193,87,147,2,212,202,19,59,89,93,230,102,182,108,152,242,115,34,216,3,232,218,205,140,15,141,2,186,224,48],[207,176,177,205,252,21,230,192,170,120,134,59,253,151,238,245,66,118,227,99,113,47,243,210,16,251,73,215,16,197,138,111],[185,161,199,161,217,139,46,168,156,12,25,38,168,240,199,111,46,183,12,153,16,190,105,147,166,117,152,190,112,47,127,30],[24,174,90,70,210,84,8,9,114,108,191,157,35,3,130,221,121,210,205,225,179,130,242,10,63,250,113,240,120,112,233,66],[228,212,122,71,68,114,41,26,229,70,185,227,201,92,109,103,41,57,27,148,20,169,165,79,13,98,134,149,146,66,226,192],[182,210,176,74,59,113,106,120,247,166,148,197,248,4,127,6,136,166,1,208,152,103,131,59,163,158,171,112,138,246,83,26],[57,202,251,228,177,226,204,59,52,3,176,36,83,232,146,238,122,14,151,0,223,3,102,227,161,178,64,89,55,169,43,98],[40,26,129,213,108,115,6,177,58,223,63,217,120,223,151,252,42,196,112,35,88,233,135,69,231,202,35,44,16,16,52,91],[253,53,194,28,146,229,113,62,240,176,110,247,60,100,236,161,47,178,100,119,73,147,7,180,73,63,178,141,165,125,34,231],[68,80,109,161,204,26,214,253,254,227,29,144,183,121,216,129,197,2,198,184,130,88,227,166,240,44,184,183,93,77,101,149],[203,242,7,87,183,112,26,188,85,150,180,35,113,142,173,155,250,159,197,101,251,138,102,151,179,70,225,94,196,193,178,58],[152,55,97,3,77,5,2,225,130,19,41,21,87,39,184,100,156,68,10,227,112,35,243,105,69,222,231,26,204,35,70,180],[40,199,135,131,238,21,67,171,163,8,78,53,146,125,150,107,89,226,27,82,83,199,170,151,58,11,57,171,161,176,141,239],[135,233,21,2,231,234,166,52,75,207,149,224,38,81,1,6,238,221,107,255,8,12,186,76,26,252,234,212,32,98,137,87],[119,102,7,39,210,0,198,101,3,182,129,92,107,104,53,12,27,178,74,24,186,200,249,13,44,170,133,96,248,255,184,87],[1,146,23,88,159,148,114,89,186,31,243,130,109,132,239,213,201,183,191,88,56,62,19,69,193,96,25,161,219,115,255,73],[148,178,17,231,202,248,210,231,164,119,5,162,243,57,121,63,39,3,29,136,135,90,58,170,104,35,193,201,79,193,150,222],[41,251,242,179,90,33,191,142,130,208,152,109,202,171,84,54,27,179,214,166,233,117,36,249,182,172,8,203,34,113,35,86],[167,117,49,97,23,91,65,150,162,220,120,39,191,236,73,214,236,13,102,151,17,55,101,178,95,143,45,155,156,62,98,6],[158,144,220,106,124,83,97,85,122,48,180,29,183,201,1,37,108,107,170,249,250,73,181,131,15,204,162,243,86,118,62,149],[33,172,204,116,94,38,31,34,248,238,145,206,199,42,178,37,121,138,67,143,95,173,171,111,99,50,1,124,216,200,176,221],[227,1,211,220,230,98,9,73,127,20,164,254,1,197,21,98,209,122,71,252,30,65,23,158,61,139,68,116,85,246,99,199],[253,60,245,81,195,205,111,88,113,4,4,6,58,132,60,30,27,209,200,12,28,26,23,31,226,114,42,133,83,53,72,175],[26,192,177,94,227,192,55,145,240,74,166,191,22,9,52,26,129,40,53,36,50,221,83,228,219,238,243,207,93,208,191,46],[46,130,145,103,6,40,95,1,170,222,125,233,93,185,171,26,154,95,242,166,24,23,164,103,190,80,73,146,18,126,41,227],[198,91,201,155,142,158,140,253,184,175,229,57,109,113,194,73,26,0,36,138,158,94,88,182,233,100,70,89,216,163,36,7],[200,39,76,218,31,134,218,1,242,122,42,190,242,145,85,69,122,31,26,194,182,5,40,20,117,54,125,187,33,164,155,225],[77,131,49,142,86,255,243,230,236,82,184,85,10,67,150,7,251,97,245,225,69,78,249,16,129,84,87,197,10,50,135,41],[224,240,46,249,235,226,104,118,162,50,188,110,87,36,114,37,120,27,143,151,68,18,23,138,7,130,193,192,106,191,7,201],[239,159,86,79,178,164,55,14,181,220,70,103,174,180,71,199,251,49,90,200,226,190,236,120,163,3,16,181,71,12,151,206],[58,200,6,85,95,202,71,200,181,239,253,135,98,192,59,129,122,136,248,164,239,179,91,241,43,36,45,203,7,21,115,79],[162,145,91,115,153,196,65,165,76,163,12,24,168,79,254,174,96,102,229,52,137,219,19,175,219,189,98,197,79,212,225,166],[117,101,111,151,94,135,225,201,203,180,157,246,103,212,211,77,96,230,13,156,251,192,147,210,243,83,234,85,189,44,182,69],[172,238,155,200,116,242,1,7,101,117,114,84,187,121,57,11,41,187,155,229,136,191,31,181,203,42,174,100,229,141,10,124],[131,187,136,11,205,196,229,50,245,123,32,253,249,10,106,164,162,123,162,246,221,116,53,79,198,220,202,56,99,45,35,201],[57,222,210,184,144,24,111,101,204,41,162,29,115,172,77,227,156,203,116,117,116,254,191,151,210,2,99,54,77,40,4,248],[121,45,212,214,233,218,233,91,43,169,11,33,36,74,135,15,127,104,110,76,77,116,142,116,171,4,237,94,0,5,107,196],[52,33,18,97,56,200,25,144,107,137,148,129,75,243,239,115,91,100,71,134,44,64,210,72,227,247,211,67,109,96,126,23],[136,145,180,3,101,24,127,197,163,32,203,61,98,193,2,109,162,234,61,150,161,93,177,123,121,84,146,211,156,107,30,150],[191,196,196,190,254,159,101,188,91,97,0,95,150,58,231,91,74,235,194,143,180,232,81,169,37,219,170,140,142,17,240,102],[54,143,113,222,218,59,145,239,10,201,112,2,203,167,20,185,207,130,240,205,84,225,157,76,89,167,15,225,199,224,5,24],[234,252,44,154,173,22,85,148,136,182,64,217,106,65,128,41,65,106,111,123,24,207,200,94,203,202,248,23,148,4,50,180],[229,4,97,177,27,68,18,130,140,222,50,16,188,110,179,227,11,55,115,72,210,196,100,79,231,239,112,182,125,25,76,111],[147,225,252,147,249,238,19,16,106,0,76,124,250,170,241,88,236,65,40,130,132,179,201,117,103,245,21,246,143,147,239,36],[30,247,116,88,192,214,61,97,119,251,93,214,150,204,162,25,91,34,72,33,69,44,8,86,62,236,240,17,132,53,144,23],[246,99,70,50,172,2,50,71,143,198,181,20,59,147,185,101,45,139,141,234,236,31,37,233,106,29,195,104,103,53,117,29],[241,111,186,224,228,236,160,234,52,84,217,53,20,56,63,202,81,155,225,126,54,198,207,228,3,245,68,183,138,89,202,209],[212,127,255,206,181,220,100,158,155,201,184,224,43,170,58,103,3,150,62,179,70,9,121,72,71,251,134,195,183,0,66,60]],{from: accounts[4]}),'revert');
  });
  it('Should fail recordPayments(address[],uint256[],uint256[],bytes32[]) when NOT comply with: _securityHolders.length == _offchainPaymentHashes.length', async () => {
    let result = await truffleAssert.fails(contractOffChainPayments.recordPayments([accounts[3],accounts[5],accounts[2],accounts[1],accounts[0],accounts[4],accounts[8],accounts[9],accounts[3],accounts[2],accounts[0],accounts[3],accounts[0],accounts[3],accounts[2],accounts[0],accounts[8],accounts[1],accounts[9],accounts[8],accounts[8],accounts[5],accounts[7],accounts[5],accounts[8],accounts[9],accounts[1],accounts[5],accounts[5],accounts[0],accounts[5],accounts[8],accounts[3],accounts[0],accounts[4],accounts[2],accounts[6],accounts[4],accounts[7],accounts[0],accounts[0],accounts[2],accounts[1],accounts[9],accounts[4],accounts[5],accounts[0],accounts[6],accounts[2],accounts[2],accounts[8],accounts[2],accounts[7],accounts[8],accounts[5],accounts[3],accounts[5],accounts[5],accounts[3],accounts[7],accounts[5],accounts[6],accounts[2],accounts[9],accounts[5],accounts[5]], [2,64,256,65,0,257,3,4,2014223716,6,4,2014223715,9999,1338,66,10000,2014223714,1532892064,97,29,97,254,66,0,1336,9999,96,2,28,2014223715,28,97,1,1336,5,255,1532892064,1338,65,95,28,1532892062,9999,10000,1532892063,9999,64,97,1,255,29,64,2014223714,257,9999,10000,6,29,10001,1337,1532892063,9999,1338,1532892063,97], [10001,2014223715,1532892064,6,6,257,2014223715,2014223716,96,27,257,256,3,2014223715,96,66,65,95,6,1532892062,3,64,96,27,10001,4,2014223715,28,257,10000,28,6,257,26,66,1337,254,6,3,1532892064,2014223714,2014223714,1338,27,97,2,64,5,65,2014223715,3,256,64,2014223714,1,256,96,2014223714,29,256,66,10001,1532892064,26,28], [[25,144,227,4,186,174,189,232,200,119,214,174,245,229,227,3,189,98,173,236,228,85,13,69,117,197,221,38,85,85,113,166],[40,242,8,207,246,165,65,47,19,210,22,60,29,153,0,141,209,236,160,201,174,75,105,174,106,76,209,115,148,73,231,150],[26,55,120,204,150,238,208,66,90,182,248,185,22,245,115,41,237,36,183,107,128,186,210,47,62,206,1,35,221,214,244,5],[200,89,104,53,139,23,254,136,245,109,122,240,58,107,179,7,199,225,136,111,224,134,19,20,99,68,125,22,150,126,235,133],[164,153,208,155,209,91,229,241,33,216,13,44,245,43,243,199,36,248,155,42,108,13,106,143,182,58,69,188,149,152,8,246],[237,88,127,151,60,246,11,174,5,153,164,1,189,8,211,245,39,195,64,41,252,173,40,186,158,56,115,172,206,217,34,38],[116,35,232,85,228,247,76,133,192,180,221,34,226,94,151,139,144,203,247,246,88,75,17,96,117,245,150,221,60,12,34,216],[202,100,106,138,7,14,112,220,0,193,23,153,56,141,241,252,62,86,34,168,58,21,212,72,165,58,41,200,135,85,102,180],[206,137,174,43,254,243,247,24,97,109,60,110,9,205,250,252,69,103,217,13,246,115,44,36,86,206,166,186,236,25,14,248],[35,64,187,161,205,246,108,194,14,59,72,60,9,136,179,111,48,21,155,165,91,247,33,79,35,73,212,151,218,136,79,74],[173,195,68,62,197,52,205,37,195,161,172,89,83,68,165,239,255,3,35,28,165,109,220,241,168,165,189,215,166,25,7,218],[234,242,40,187,89,27,26,198,118,242,253,162,255,149,222,34,100,74,164,100,179,108,119,33,248,104,169,10,31,104,14,222],[105,163,226,140,143,96,139,67,21,124,92,52,248,86,73,45,175,121,230,206,102,213,32,214,19,186,234,189,253,75,159,29],[220,64,182,11,158,254,231,47,16,202,92,104,80,90,134,176,110,6,153,169,13,37,108,30,153,214,245,158,254,35,87,176],[175,230,113,244,42,0,249,182,176,178,58,41,216,90,94,237,18,250,50,223,37,230,181,94,91,107,100,33,31,82,103,116],[146,230,143,25,17,232,67,157,170,100,246,61,134,160,242,66,79,61,184,60,64,171,147,193,174,133,111,115,159,155,126,62],[51,110,231,228,94,117,64,161,70,107,52,110,121,140,7,52,221,203,163,247,136,91,162,94,146,129,120,56,1,171,151,165],[134,173,193,87,147,2,212,202,19,59,89,93,230,102,182,108,152,242,115,34,216,3,232,218,205,140,15,141,2,186,224,48],[207,176,177,205,252,21,230,192,170,120,134,59,253,151,238,245,66,118,227,99,113,47,243,210,16,251,73,215,16,197,138,111],[185,161,199,161,217,139,46,168,156,12,25,38,168,240,199,111,46,183,12,153,16,190,105,147,166,117,152,190,112,47,127,30],[24,174,90,70,210,84,8,9,114,108,191,157,35,3,130,221,121,210,205,225,179,130,242,10,63,250,113,240,120,112,233,66],[228,212,122,71,68,114,41,26,229,70,185,227,201,92,109,103,41,57,27,148,20,169,165,79,13,98,134,149,146,66,226,192],[182,210,176,74,59,113,106,120,247,166,148,197,248,4,127,6,136,166,1,208,152,103,131,59,163,158,171,112,138,246,83,26],[57,202,251,228,177,226,204,59,52,3,176,36,83,232,146,238,122,14,151,0,223,3,102,227,161,178,64,89,55,169,43,98],[40,26,129,213,108,115,6,177,58,223,63,217,120,223,151,252,42,196,112,35,88,233,135,69,231,202,35,44,16,16,52,91],[253,53,194,28,146,229,113,62,240,176,110,247,60,100,236,161,47,178,100,119,73,147,7,180,73,63,178,141,165,125,34,231],[68,80,109,161,204,26,214,253,254,227,29,144,183,121,216,129,197,2,198,184,130,88,227,166,240,44,184,183,93,77,101,149],[203,242,7,87,183,112,26,188,85,150,180,35,113,142,173,155,250,159,197,101,251,138,102,151,179,70,225,94,196,193,178,58],[152,55,97,3,77,5,2,225,130,19,41,21,87,39,184,100,156,68,10,227,112,35,243,105,69,222,231,26,204,35,70,180],[40,199,135,131,238,21,67,171,163,8,78,53,146,125,150,107,89,226,27,82,83,199,170,151,58,11,57,171,161,176,141,239],[135,233,21,2,231,234,166,52,75,207,149,224,38,81,1,6,238,221,107,255,8,12,186,76,26,252,234,212,32,98,137,87],[119,102,7,39,210,0,198,101,3,182,129,92,107,104,53,12,27,178,74,24,186,200,249,13,44,170,133,96,248,255,184,87],[1,146,23,88,159,148,114,89,186,31,243,130,109,132,239,213,201,183,191,88,56,62,19,69,193,96,25,161,219,115,255,73],[148,178,17,231,202,248,210,231,164,119,5,162,243,57,121,63,39,3,29,136,135,90,58,170,104,35,193,201,79,193,150,222],[41,251,242,179,90,33,191,142,130,208,152,109,202,171,84,54,27,179,214,166,233,117,36,249,182,172,8,203,34,113,35,86],[167,117,49,97,23,91,65,150,162,220,120,39,191,236,73,214,236,13,102,151,17,55,101,178,95,143,45,155,156,62,98,6],[158,144,220,106,124,83,97,85,122,48,180,29,183,201,1,37,108,107,170,249,250,73,181,131,15,204,162,243,86,118,62,149],[33,172,204,116,94,38,31,34,248,238,145,206,199,42,178,37,121,138,67,143,95,173,171,111,99,50,1,124,216,200,176,221],[227,1,211,220,230,98,9,73,127,20,164,254,1,197,21,98,209,122,71,252,30,65,23,158,61,139,68,116,85,246,99,199],[253,60,245,81,195,205,111,88,113,4,4,6,58,132,60,30,27,209,200,12,28,26,23,31,226,114,42,133,83,53,72,175],[26,192,177,94,227,192,55,145,240,74,166,191,22,9,52,26,129,40,53,36,50,221,83,228,219,238,243,207,93,208,191,46],[46,130,145,103,6,40,95,1,170,222,125,233,93,185,171,26,154,95,242,166,24,23,164,103,190,80,73,146,18,126,41,227],[198,91,201,155,142,158,140,253,184,175,229,57,109,113,194,73,26,0,36,138,158,94,88,182,233,100,70,89,216,163,36,7],[200,39,76,218,31,134,218,1,242,122,42,190,242,145,85,69,122,31,26,194,182,5,40,20,117,54,125,187,33,164,155,225],[77,131,49,142,86,255,243,230,236,82,184,85,10,67,150,7,251,97,245,225,69,78,249,16,129,84,87,197,10,50,135,41],[224,240,46,249,235,226,104,118,162,50,188,110,87,36,114,37,120,27,143,151,68,18,23,138,7,130,193,192,106,191,7,201],[239,159,86,79,178,164,55,14,181,220,70,103,174,180,71,199,251,49,90,200,226,190,236,120,163,3,16,181,71,12,151,206],[58,200,6,85,95,202,71,200,181,239,253,135,98,192,59,129,122,136,248,164,239,179,91,241,43,36,45,203,7,21,115,79],[162,145,91,115,153,196,65,165,76,163,12,24,168,79,254,174,96,102,229,52,137,219,19,175,219,189,98,197,79,212,225,166],[117,101,111,151,94,135,225,201,203,180,157,246,103,212,211,77,96,230,13,156,251,192,147,210,243,83,234,85,189,44,182,69],[172,238,155,200,116,242,1,7,101,117,114,84,187,121,57,11,41,187,155,229,136,191,31,181,203,42,174,100,229,141,10,124],[131,187,136,11,205,196,229,50,245,123,32,253,249,10,106,164,162,123,162,246,221,116,53,79,198,220,202,56,99,45,35,201],[57,222,210,184,144,24,111,101,204,41,162,29,115,172,77,227,156,203,116,117,116,254,191,151,210,2,99,54,77,40,4,248],[121,45,212,214,233,218,233,91,43,169,11,33,36,74,135,15,127,104,110,76,77,116,142,116,171,4,237,94,0,5,107,196],[52,33,18,97,56,200,25,144,107,137,148,129,75,243,239,115,91,100,71,134,44,64,210,72,227,247,211,67,109,96,126,23],[136,145,180,3,101,24,127,197,163,32,203,61,98,193,2,109,162,234,61,150,161,93,177,123,121,84,146,211,156,107,30,150],[191,196,196,190,254,159,101,188,91,97,0,95,150,58,231,91,74,235,194,143,180,232,81,169,37,219,170,140,142,17,240,102],[54,143,113,222,218,59,145,239,10,201,112,2,203,167,20,185,207,130,240,205,84,225,157,76,89,167,15,225,199,224,5,24],[234,252,44,154,173,22,85,148,136,182,64,217,106,65,128,41,65,106,111,123,24,207,200,94,203,202,248,23,148,4,50,180],[229,4,97,177,27,68,18,130,140,222,50,16,188,110,179,227,11,55,115,72,210,196,100,79,231,239,112,182,125,25,76,111],[147,225,252,147,249,238,19,16,106,0,76,124,250,170,241,88,236,65,40,130,132,179,201,117,103,245,21,246,143,147,239,36],[30,247,116,88,192,214,61,97,119,251,93,214,150,204,162,25,91,34,72,33,69,44,8,86,62,236,240,17,132,53,144,23],[246,99,70,50,172,2,50,71,143,198,181,20,59,147,185,101,45,139,141,234,236,31,37,233,106,29,195,104,103,53,117,29],[241,111,186,224,228,236,160,234,52,84,217,53,20,56,63,202,81,155,225,126,54,198,207,228,3,245,68,183,138,89,202,209],[212,127,255,206,181,220,100,158,155,201,184,224,43,170,58,103,3,150,62,179,70,9,121,72,71,251,134,195,183,0,66,60]],{from: accounts[4]}),'revert');
  });
  it('Should fail recordPayments(address[],uint256[],uint256[],bytes32[]) when NOT comply with: _securityHolders.length == _paymentTimestamps.length', async () => {
    let result = await truffleAssert.fails(contractOffChainPayments.recordPayments([accounts[9],accounts[6],accounts[1],accounts[4],accounts[7],accounts[4],accounts[3],accounts[9],accounts[6],accounts[5],accounts[1],accounts[4],accounts[0],accounts[5],accounts[0],accounts[3],accounts[0],accounts[7],accounts[0],accounts[0],accounts[1],accounts[7],accounts[6],accounts[6],accounts[7],accounts[5],accounts[9],accounts[2],accounts[7],accounts[7],accounts[9],accounts[6],accounts[6],accounts[7],accounts[2],accounts[4],accounts[1],accounts[9],accounts[5],accounts[2],accounts[2],accounts[1],accounts[8],accounts[9],accounts[6],accounts[2],accounts[7],accounts[2],accounts[9],accounts[5],accounts[2],accounts[2],accounts[8],accounts[1],accounts[3],accounts[6],accounts[7],accounts[0],accounts[4],accounts[9],accounts[6],accounts[1],accounts[7],accounts[2],accounts[2],accounts[0]], [2,64,256,65,0,257,3,4,2014223716,6,4,2014223715,9999,1338,66,10000,2014223714,1532892064,97,29,97,254,66,0,1336,9999,96,2,28,2014223715,28,97,1,1336,5,255,1532892064,1338,65,95,28,1532892062,9999,10000,1532892063,9999,64,97,1,255,29,64,2014223714,257,9999,10000,6,29,10001,1337,1532892063,9999,1338,1532892063,97], [10001,2014223715,1532892064,6,6,257,2014223715,2014223716,96,27,257,256,3,2014223715,96,66,65,95,6,1532892062,3,64,96,27,10001,4,2014223715,28,257,10000,28,6,257,26,66,1337,254,6,3,1532892064,2014223714,2014223714,1338,27,97,2,64,5,65,2014223715,3,256,64,2014223714,1,256,96,2014223714,29,256,66,10001,1532892064,26,28], [[25,144,227,4,186,174,189,232,200,119,214,174,245,229,227,3,189,98,173,236,228,85,13,69,117,197,221,38,85,85,113,166],[40,242,8,207,246,165,65,47,19,210,22,60,29,153,0,141,209,236,160,201,174,75,105,174,106,76,209,115,148,73,231,150],[26,55,120,204,150,238,208,66,90,182,248,185,22,245,115,41,237,36,183,107,128,186,210,47,62,206,1,35,221,214,244,5],[200,89,104,53,139,23,254,136,245,109,122,240,58,107,179,7,199,225,136,111,224,134,19,20,99,68,125,22,150,126,235,133],[164,153,208,155,209,91,229,241,33,216,13,44,245,43,243,199,36,248,155,42,108,13,106,143,182,58,69,188,149,152,8,246],[237,88,127,151,60,246,11,174,5,153,164,1,189,8,211,245,39,195,64,41,252,173,40,186,158,56,115,172,206,217,34,38],[116,35,232,85,228,247,76,133,192,180,221,34,226,94,151,139,144,203,247,246,88,75,17,96,117,245,150,221,60,12,34,216],[202,100,106,138,7,14,112,220,0,193,23,153,56,141,241,252,62,86,34,168,58,21,212,72,165,58,41,200,135,85,102,180],[206,137,174,43,254,243,247,24,97,109,60,110,9,205,250,252,69,103,217,13,246,115,44,36,86,206,166,186,236,25,14,248],[35,64,187,161,205,246,108,194,14,59,72,60,9,136,179,111,48,21,155,165,91,247,33,79,35,73,212,151,218,136,79,74],[173,195,68,62,197,52,205,37,195,161,172,89,83,68,165,239,255,3,35,28,165,109,220,241,168,165,189,215,166,25,7,218],[234,242,40,187,89,27,26,198,118,242,253,162,255,149,222,34,100,74,164,100,179,108,119,33,248,104,169,10,31,104,14,222],[105,163,226,140,143,96,139,67,21,124,92,52,248,86,73,45,175,121,230,206,102,213,32,214,19,186,234,189,253,75,159,29],[220,64,182,11,158,254,231,47,16,202,92,104,80,90,134,176,110,6,153,169,13,37,108,30,153,214,245,158,254,35,87,176],[175,230,113,244,42,0,249,182,176,178,58,41,216,90,94,237,18,250,50,223,37,230,181,94,91,107,100,33,31,82,103,116],[146,230,143,25,17,232,67,157,170,100,246,61,134,160,242,66,79,61,184,60,64,171,147,193,174,133,111,115,159,155,126,62],[51,110,231,228,94,117,64,161,70,107,52,110,121,140,7,52,221,203,163,247,136,91,162,94,146,129,120,56,1,171,151,165],[134,173,193,87,147,2,212,202,19,59,89,93,230,102,182,108,152,242,115,34,216,3,232,218,205,140,15,141,2,186,224,48],[207,176,177,205,252,21,230,192,170,120,134,59,253,151,238,245,66,118,227,99,113,47,243,210,16,251,73,215,16,197,138,111],[185,161,199,161,217,139,46,168,156,12,25,38,168,240,199,111,46,183,12,153,16,190,105,147,166,117,152,190,112,47,127,30],[24,174,90,70,210,84,8,9,114,108,191,157,35,3,130,221,121,210,205,225,179,130,242,10,63,250,113,240,120,112,233,66],[228,212,122,71,68,114,41,26,229,70,185,227,201,92,109,103,41,57,27,148,20,169,165,79,13,98,134,149,146,66,226,192],[182,210,176,74,59,113,106,120,247,166,148,197,248,4,127,6,136,166,1,208,152,103,131,59,163,158,171,112,138,246,83,26],[57,202,251,228,177,226,204,59,52,3,176,36,83,232,146,238,122,14,151,0,223,3,102,227,161,178,64,89,55,169,43,98],[40,26,129,213,108,115,6,177,58,223,63,217,120,223,151,252,42,196,112,35,88,233,135,69,231,202,35,44,16,16,52,91],[253,53,194,28,146,229,113,62,240,176,110,247,60,100,236,161,47,178,100,119,73,147,7,180,73,63,178,141,165,125,34,231],[68,80,109,161,204,26,214,253,254,227,29,144,183,121,216,129,197,2,198,184,130,88,227,166,240,44,184,183,93,77,101,149],[203,242,7,87,183,112,26,188,85,150,180,35,113,142,173,155,250,159,197,101,251,138,102,151,179,70,225,94,196,193,178,58],[152,55,97,3,77,5,2,225,130,19,41,21,87,39,184,100,156,68,10,227,112,35,243,105,69,222,231,26,204,35,70,180],[40,199,135,131,238,21,67,171,163,8,78,53,146,125,150,107,89,226,27,82,83,199,170,151,58,11,57,171,161,176,141,239],[135,233,21,2,231,234,166,52,75,207,149,224,38,81,1,6,238,221,107,255,8,12,186,76,26,252,234,212,32,98,137,87],[119,102,7,39,210,0,198,101,3,182,129,92,107,104,53,12,27,178,74,24,186,200,249,13,44,170,133,96,248,255,184,87],[1,146,23,88,159,148,114,89,186,31,243,130,109,132,239,213,201,183,191,88,56,62,19,69,193,96,25,161,219,115,255,73],[148,178,17,231,202,248,210,231,164,119,5,162,243,57,121,63,39,3,29,136,135,90,58,170,104,35,193,201,79,193,150,222],[41,251,242,179,90,33,191,142,130,208,152,109,202,171,84,54,27,179,214,166,233,117,36,249,182,172,8,203,34,113,35,86],[167,117,49,97,23,91,65,150,162,220,120,39,191,236,73,214,236,13,102,151,17,55,101,178,95,143,45,155,156,62,98,6],[158,144,220,106,124,83,97,85,122,48,180,29,183,201,1,37,108,107,170,249,250,73,181,131,15,204,162,243,86,118,62,149],[33,172,204,116,94,38,31,34,248,238,145,206,199,42,178,37,121,138,67,143,95,173,171,111,99,50,1,124,216,200,176,221],[227,1,211,220,230,98,9,73,127,20,164,254,1,197,21,98,209,122,71,252,30,65,23,158,61,139,68,116,85,246,99,199],[253,60,245,81,195,205,111,88,113,4,4,6,58,132,60,30,27,209,200,12,28,26,23,31,226,114,42,133,83,53,72,175],[26,192,177,94,227,192,55,145,240,74,166,191,22,9,52,26,129,40,53,36,50,221,83,228,219,238,243,207,93,208,191,46],[46,130,145,103,6,40,95,1,170,222,125,233,93,185,171,26,154,95,242,166,24,23,164,103,190,80,73,146,18,126,41,227],[198,91,201,155,142,158,140,253,184,175,229,57,109,113,194,73,26,0,36,138,158,94,88,182,233,100,70,89,216,163,36,7],[200,39,76,218,31,134,218,1,242,122,42,190,242,145,85,69,122,31,26,194,182,5,40,20,117,54,125,187,33,164,155,225],[77,131,49,142,86,255,243,230,236,82,184,85,10,67,150,7,251,97,245,225,69,78,249,16,129,84,87,197,10,50,135,41],[224,240,46,249,235,226,104,118,162,50,188,110,87,36,114,37,120,27,143,151,68,18,23,138,7,130,193,192,106,191,7,201],[239,159,86,79,178,164,55,14,181,220,70,103,174,180,71,199,251,49,90,200,226,190,236,120,163,3,16,181,71,12,151,206],[58,200,6,85,95,202,71,200,181,239,253,135,98,192,59,129,122,136,248,164,239,179,91,241,43,36,45,203,7,21,115,79],[162,145,91,115,153,196,65,165,76,163,12,24,168,79,254,174,96,102,229,52,137,219,19,175,219,189,98,197,79,212,225,166],[117,101,111,151,94,135,225,201,203,180,157,246,103,212,211,77,96,230,13,156,251,192,147,210,243,83,234,85,189,44,182,69],[172,238,155,200,116,242,1,7,101,117,114,84,187,121,57,11,41,187,155,229,136,191,31,181,203,42,174,100,229,141,10,124],[131,187,136,11,205,196,229,50,245,123,32,253,249,10,106,164,162,123,162,246,221,116,53,79,198,220,202,56,99,45,35,201],[57,222,210,184,144,24,111,101,204,41,162,29,115,172,77,227,156,203,116,117,116,254,191,151,210,2,99,54,77,40,4,248],[121,45,212,214,233,218,233,91,43,169,11,33,36,74,135,15,127,104,110,76,77,116,142,116,171,4,237,94,0,5,107,196],[52,33,18,97,56,200,25,144,107,137,148,129,75,243,239,115,91,100,71,134,44,64,210,72,227,247,211,67,109,96,126,23],[136,145,180,3,101,24,127,197,163,32,203,61,98,193,2,109,162,234,61,150,161,93,177,123,121,84,146,211,156,107,30,150],[191,196,196,190,254,159,101,188,91,97,0,95,150,58,231,91,74,235,194,143,180,232,81,169,37,219,170,140,142,17,240,102],[54,143,113,222,218,59,145,239,10,201,112,2,203,167,20,185,207,130,240,205,84,225,157,76,89,167,15,225,199,224,5,24],[234,252,44,154,173,22,85,148,136,182,64,217,106,65,128,41,65,106,111,123,24,207,200,94,203,202,248,23,148,4,50,180],[229,4,97,177,27,68,18,130,140,222,50,16,188,110,179,227,11,55,115,72,210,196,100,79,231,239,112,182,125,25,76,111],[147,225,252,147,249,238,19,16,106,0,76,124,250,170,241,88,236,65,40,130,132,179,201,117,103,245,21,246,143,147,239,36],[30,247,116,88,192,214,61,97,119,251,93,214,150,204,162,25,91,34,72,33,69,44,8,86,62,236,240,17,132,53,144,23],[246,99,70,50,172,2,50,71,143,198,181,20,59,147,185,101,45,139,141,234,236,31,37,233,106,29,195,104,103,53,117,29],[241,111,186,224,228,236,160,234,52,84,217,53,20,56,63,202,81,155,225,126,54,198,207,228,3,245,68,183,138,89,202,209],[212,127,255,206,181,220,100,158,155,201,184,224,43,170,58,103,3,150,62,179,70,9,121,72,71,251,134,195,183,0,66,60]],{from: accounts[4]}),'revert');
  });
  it('Should fail recordPayments(address[],uint256[],uint256[],bytes32[]) when NOT comply with: _securityHolders.length == _paymentValues.length', async () => {
    let result = await truffleAssert.fails(contractOffChainPayments.recordPayments([accounts[7],accounts[8],accounts[1],accounts[8],accounts[8],accounts[3],accounts[0],accounts[8],accounts[5],accounts[2],accounts[9],accounts[6],accounts[8],accounts[4],accounts[6],accounts[8],accounts[3],accounts[5],accounts[1],accounts[1],accounts[2],accounts[3],accounts[6],accounts[5],accounts[9],accounts[5],accounts[2],accounts[4],accounts[8],accounts[0],accounts[8],accounts[5],accounts[9],accounts[1],accounts[8],accounts[5],accounts[8],accounts[5],accounts[8],accounts[8],accounts[3],accounts[9],accounts[0],accounts[3],accounts[7],accounts[3],accounts[6],accounts[2],accounts[1],accounts[1],accounts[4],accounts[2],accounts[4],accounts[0],accounts[2],accounts[4],accounts[9],accounts[2],accounts[0],accounts[3],accounts[0],accounts[4],accounts[8],accounts[9],accounts[3],accounts[8]], [2,64,256,65,0,257,3,4,2014223716,6,4,2014223715,9999,1338,66,10000,2014223714,1532892064,97,29,97,254,66,0,1336,9999,96,2,28,2014223715,28,97,1,1336,5,255,1532892064,1338,65,95,28,1532892062,9999,10000,1532892063,9999,64,97,1,255,29,64,2014223714,257,9999,10000,6,29,10001,1337,1532892063,9999,1338,1532892063,97], [10001,2014223715,1532892064,6,6,257,2014223715,2014223716,96,27,257,256,3,2014223715,96,66,65,95,6,1532892062,3,64,96,27,10001,4,2014223715,28,257,10000,28,6,257,26,66,1337,254,6,3,1532892064,2014223714,2014223714,1338,27,97,2,64,5,65,2014223715,3,256,64,2014223714,1,256,96,2014223714,29,256,66,10001,1532892064,26,28], [[25,144,227,4,186,174,189,232,200,119,214,174,245,229,227,3,189,98,173,236,228,85,13,69,117,197,221,38,85,85,113,166],[40,242,8,207,246,165,65,47,19,210,22,60,29,153,0,141,209,236,160,201,174,75,105,174,106,76,209,115,148,73,231,150],[26,55,120,204,150,238,208,66,90,182,248,185,22,245,115,41,237,36,183,107,128,186,210,47,62,206,1,35,221,214,244,5],[200,89,104,53,139,23,254,136,245,109,122,240,58,107,179,7,199,225,136,111,224,134,19,20,99,68,125,22,150,126,235,133],[164,153,208,155,209,91,229,241,33,216,13,44,245,43,243,199,36,248,155,42,108,13,106,143,182,58,69,188,149,152,8,246],[237,88,127,151,60,246,11,174,5,153,164,1,189,8,211,245,39,195,64,41,252,173,40,186,158,56,115,172,206,217,34,38],[116,35,232,85,228,247,76,133,192,180,221,34,226,94,151,139,144,203,247,246,88,75,17,96,117,245,150,221,60,12,34,216],[202,100,106,138,7,14,112,220,0,193,23,153,56,141,241,252,62,86,34,168,58,21,212,72,165,58,41,200,135,85,102,180],[206,137,174,43,254,243,247,24,97,109,60,110,9,205,250,252,69,103,217,13,246,115,44,36,86,206,166,186,236,25,14,248],[35,64,187,161,205,246,108,194,14,59,72,60,9,136,179,111,48,21,155,165,91,247,33,79,35,73,212,151,218,136,79,74],[173,195,68,62,197,52,205,37,195,161,172,89,83,68,165,239,255,3,35,28,165,109,220,241,168,165,189,215,166,25,7,218],[234,242,40,187,89,27,26,198,118,242,253,162,255,149,222,34,100,74,164,100,179,108,119,33,248,104,169,10,31,104,14,222],[105,163,226,140,143,96,139,67,21,124,92,52,248,86,73,45,175,121,230,206,102,213,32,214,19,186,234,189,253,75,159,29],[220,64,182,11,158,254,231,47,16,202,92,104,80,90,134,176,110,6,153,169,13,37,108,30,153,214,245,158,254,35,87,176],[175,230,113,244,42,0,249,182,176,178,58,41,216,90,94,237,18,250,50,223,37,230,181,94,91,107,100,33,31,82,103,116],[146,230,143,25,17,232,67,157,170,100,246,61,134,160,242,66,79,61,184,60,64,171,147,193,174,133,111,115,159,155,126,62],[51,110,231,228,94,117,64,161,70,107,52,110,121,140,7,52,221,203,163,247,136,91,162,94,146,129,120,56,1,171,151,165],[134,173,193,87,147,2,212,202,19,59,89,93,230,102,182,108,152,242,115,34,216,3,232,218,205,140,15,141,2,186,224,48],[207,176,177,205,252,21,230,192,170,120,134,59,253,151,238,245,66,118,227,99,113,47,243,210,16,251,73,215,16,197,138,111],[185,161,199,161,217,139,46,168,156,12,25,38,168,240,199,111,46,183,12,153,16,190,105,147,166,117,152,190,112,47,127,30],[24,174,90,70,210,84,8,9,114,108,191,157,35,3,130,221,121,210,205,225,179,130,242,10,63,250,113,240,120,112,233,66],[228,212,122,71,68,114,41,26,229,70,185,227,201,92,109,103,41,57,27,148,20,169,165,79,13,98,134,149,146,66,226,192],[182,210,176,74,59,113,106,120,247,166,148,197,248,4,127,6,136,166,1,208,152,103,131,59,163,158,171,112,138,246,83,26],[57,202,251,228,177,226,204,59,52,3,176,36,83,232,146,238,122,14,151,0,223,3,102,227,161,178,64,89,55,169,43,98],[40,26,129,213,108,115,6,177,58,223,63,217,120,223,151,252,42,196,112,35,88,233,135,69,231,202,35,44,16,16,52,91],[253,53,194,28,146,229,113,62,240,176,110,247,60,100,236,161,47,178,100,119,73,147,7,180,73,63,178,141,165,125,34,231],[68,80,109,161,204,26,214,253,254,227,29,144,183,121,216,129,197,2,198,184,130,88,227,166,240,44,184,183,93,77,101,149],[203,242,7,87,183,112,26,188,85,150,180,35,113,142,173,155,250,159,197,101,251,138,102,151,179,70,225,94,196,193,178,58],[152,55,97,3,77,5,2,225,130,19,41,21,87,39,184,100,156,68,10,227,112,35,243,105,69,222,231,26,204,35,70,180],[40,199,135,131,238,21,67,171,163,8,78,53,146,125,150,107,89,226,27,82,83,199,170,151,58,11,57,171,161,176,141,239],[135,233,21,2,231,234,166,52,75,207,149,224,38,81,1,6,238,221,107,255,8,12,186,76,26,252,234,212,32,98,137,87],[119,102,7,39,210,0,198,101,3,182,129,92,107,104,53,12,27,178,74,24,186,200,249,13,44,170,133,96,248,255,184,87],[1,146,23,88,159,148,114,89,186,31,243,130,109,132,239,213,201,183,191,88,56,62,19,69,193,96,25,161,219,115,255,73],[148,178,17,231,202,248,210,231,164,119,5,162,243,57,121,63,39,3,29,136,135,90,58,170,104,35,193,201,79,193,150,222],[41,251,242,179,90,33,191,142,130,208,152,109,202,171,84,54,27,179,214,166,233,117,36,249,182,172,8,203,34,113,35,86],[167,117,49,97,23,91,65,150,162,220,120,39,191,236,73,214,236,13,102,151,17,55,101,178,95,143,45,155,156,62,98,6],[158,144,220,106,124,83,97,85,122,48,180,29,183,201,1,37,108,107,170,249,250,73,181,131,15,204,162,243,86,118,62,149],[33,172,204,116,94,38,31,34,248,238,145,206,199,42,178,37,121,138,67,143,95,173,171,111,99,50,1,124,216,200,176,221],[227,1,211,220,230,98,9,73,127,20,164,254,1,197,21,98,209,122,71,252,30,65,23,158,61,139,68,116,85,246,99,199],[253,60,245,81,195,205,111,88,113,4,4,6,58,132,60,30,27,209,200,12,28,26,23,31,226,114,42,133,83,53,72,175],[26,192,177,94,227,192,55,145,240,74,166,191,22,9,52,26,129,40,53,36,50,221,83,228,219,238,243,207,93,208,191,46],[46,130,145,103,6,40,95,1,170,222,125,233,93,185,171,26,154,95,242,166,24,23,164,103,190,80,73,146,18,126,41,227],[198,91,201,155,142,158,140,253,184,175,229,57,109,113,194,73,26,0,36,138,158,94,88,182,233,100,70,89,216,163,36,7],[200,39,76,218,31,134,218,1,242,122,42,190,242,145,85,69,122,31,26,194,182,5,40,20,117,54,125,187,33,164,155,225],[77,131,49,142,86,255,243,230,236,82,184,85,10,67,150,7,251,97,245,225,69,78,249,16,129,84,87,197,10,50,135,41],[224,240,46,249,235,226,104,118,162,50,188,110,87,36,114,37,120,27,143,151,68,18,23,138,7,130,193,192,106,191,7,201],[239,159,86,79,178,164,55,14,181,220,70,103,174,180,71,199,251,49,90,200,226,190,236,120,163,3,16,181,71,12,151,206],[58,200,6,85,95,202,71,200,181,239,253,135,98,192,59,129,122,136,248,164,239,179,91,241,43,36,45,203,7,21,115,79],[162,145,91,115,153,196,65,165,76,163,12,24,168,79,254,174,96,102,229,52,137,219,19,175,219,189,98,197,79,212,225,166],[117,101,111,151,94,135,225,201,203,180,157,246,103,212,211,77,96,230,13,156,251,192,147,210,243,83,234,85,189,44,182,69],[172,238,155,200,116,242,1,7,101,117,114,84,187,121,57,11,41,187,155,229,136,191,31,181,203,42,174,100,229,141,10,124],[131,187,136,11,205,196,229,50,245,123,32,253,249,10,106,164,162,123,162,246,221,116,53,79,198,220,202,56,99,45,35,201],[57,222,210,184,144,24,111,101,204,41,162,29,115,172,77,227,156,203,116,117,116,254,191,151,210,2,99,54,77,40,4,248],[121,45,212,214,233,218,233,91,43,169,11,33,36,74,135,15,127,104,110,76,77,116,142,116,171,4,237,94,0,5,107,196],[52,33,18,97,56,200,25,144,107,137,148,129,75,243,239,115,91,100,71,134,44,64,210,72,227,247,211,67,109,96,126,23],[136,145,180,3,101,24,127,197,163,32,203,61,98,193,2,109,162,234,61,150,161,93,177,123,121,84,146,211,156,107,30,150],[191,196,196,190,254,159,101,188,91,97,0,95,150,58,231,91,74,235,194,143,180,232,81,169,37,219,170,140,142,17,240,102],[54,143,113,222,218,59,145,239,10,201,112,2,203,167,20,185,207,130,240,205,84,225,157,76,89,167,15,225,199,224,5,24],[234,252,44,154,173,22,85,148,136,182,64,217,106,65,128,41,65,106,111,123,24,207,200,94,203,202,248,23,148,4,50,180],[229,4,97,177,27,68,18,130,140,222,50,16,188,110,179,227,11,55,115,72,210,196,100,79,231,239,112,182,125,25,76,111],[147,225,252,147,249,238,19,16,106,0,76,124,250,170,241,88,236,65,40,130,132,179,201,117,103,245,21,246,143,147,239,36],[30,247,116,88,192,214,61,97,119,251,93,214,150,204,162,25,91,34,72,33,69,44,8,86,62,236,240,17,132,53,144,23],[246,99,70,50,172,2,50,71,143,198,181,20,59,147,185,101,45,139,141,234,236,31,37,233,106,29,195,104,103,53,117,29],[241,111,186,224,228,236,160,234,52,84,217,53,20,56,63,202,81,155,225,126,54,198,207,228,3,245,68,183,138,89,202,209],[212,127,255,206,181,220,100,158,155,201,184,224,43,170,58,103,3,150,62,179,70,9,121,72,71,251,134,195,183,0,66,60]],{from: accounts[4]}),'revert');
  });
  it('Should execute lookUpPaymentIndex(address,bytes32) WHEN _securityHolder!=0x0000000000000000000000000000000000000000', async () => {
    let result = await contractOffChainPayments.lookUpPaymentIndex(accounts[6], [255,58,252,254,59,37,0,226,151,59,56,45,95,93,204,68,73,143,40,58,177,239,24,57,237,186,195,57,15,225,41,113],{from: accounts[0]});
  });
  it('Should fail lookUpPaymentIndex(address,bytes32) when NOT comply with: _securityHolder != 0x0000000000000000000000000000000000000000', async () => {
    let result = await truffleAssert.fails(contractOffChainPayments.lookUpPaymentIndex("0x0000000000000000000000000000000000000000", [255,58,252,254,59,37,0,226,151,59,56,45,95,93,204,68,73,143,40,58,177,239,24,57,237,186,195,57,15,225,41,113],{from: accounts[0]}),'revert');
  });
  it('Should execute challengePayment(uint256,uint256)', async () => {
    let result = await contractOffChainPayments.challengePayment(10001, 2014223716,{from: accounts[0]});
  });
  it('Should execute resolveChallenge(address,uint256,bytes32,uint256) WHEN currentValue==_newValue,msg.sender==_owner,_index>=0', async () => {
    let result = await contractOffChainPayments.resolveChallenge(accounts[9], 0, [97,48,73,79,250,163,233,17,219,130,173,204,119,26,208,69,172,199,48,68,52,74,106,142,132,253,112,225,244,36,15,104], 97,{from: accounts[4]});
  });
  it('Should fail resolveChallenge(address,uint256,bytes32,uint256) when NOT comply with: msg.sender == _owner', async () => {
    let result = await truffleAssert.fails(contractOffChainPayments.resolveChallenge(accounts[9], 0, [97,48,73,79,250,163,233,17,219,130,173,204,119,26,208,69,172,199,48,68,52,74,106,142,132,253,112,225,244,36,15,104], 97,{from: accounts[9]}),'revert');
  });
  it('Should fail resolveChallenge(address,uint256,bytes32,uint256) when NOT comply with: _index >= 0', async () => {
    let result = await truffleAssert.fails(contractOffChainPayments.resolveChallenge(accounts[9], -1, [97,48,73,79,250,163,233,17,219,130,173,204,119,26,208,69,172,199,48,68,52,74,106,142,132,253,112,225,244,36,15,104], 97,{from: accounts[4]}),'revert');
  });
  it('Should execute resolveChallenge(address,uint256,bytes32,uint256) WHEN currentValue!=_newValue,msg.sender==_owner,_index>=0', async () => {
    let result = await contractOffChainPayments.resolveChallenge(accounts[5], 1532892062, [186,231,218,87,3,238,139,100,184,117,15,167,15,143,241,194,70,229,44,42,235,178,138,187,8,64,28,29,89,224,58,14], 255,{from: accounts[4]});
  });
  it('Should fail resolveChallenge(address,uint256,bytes32,uint256) when NOT comply with: msg.sender == _owner', async () => {
    let result = await truffleAssert.fails(contractOffChainPayments.resolveChallenge(accounts[5], 1532892062, [186,231,218,87,3,238,139,100,184,117,15,167,15,143,241,194,70,229,44,42,235,178,138,187,8,64,28,29,89,224,58,14], 255,{from: accounts[9]}),'revert');
  });
  it('Should fail resolveChallenge(address,uint256,bytes32,uint256) when NOT comply with: _index >= 0', async () => {
    let result = await truffleAssert.fails(contractOffChainPayments.resolveChallenge(accounts[5], -1, [186,231,218,87,3,238,139,100,184,117,15,167,15,143,241,194,70,229,44,42,235,178,138,187,8,64,28,29,89,224,58,14], 255,{from: accounts[4]}),'revert');
  });
});
